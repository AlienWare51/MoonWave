<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EaselJS Game</title>
    <script src="https://code.createjs.com/1.0.0/easeljs.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; }
        #coords {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: rgba(255,255,255,0.8);
            padding: 5px;
            border-radius: 5px;
            font-family: Arial, sans-serif;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <div id="coords">Coordinates: (x, y)</div>

    <script>
        const stage = new createjs.Stage("gameCanvas");

        // Load the images with crossOrigin set
        const deskPhotoImg = new Image();
        const lizardManImg = new Image();
        const newImage = new Image();

        deskPhotoImg.crossOrigin = 'Anonymous';
        lizardManImg.crossOrigin = 'Anonymous';
        newImage.crossOrigin = 'Anonymous';

        deskPhotoImg.src = 'https://example.com/deskPhoto.jpg'; // Replace with valid URLs
        lizardManImg.src = 'https://example.com/lizardMan.jpg';
        newImage.src = 'https://example.com/minion.png';

        let imagesLoaded = 0;
        deskPhotoImg.onload = handleImageLoad;
        lizardManImg.onload = handleImageLoad;
        newImage.onload = handleImageLoad;

        let deskPhotoBitmap;
        let lizardManBitmap;
        let pointer;
        let minion; // Minion object
        const coordsDisplay = document.getElementById('coords');

        // Minion object definition
        const Minion = {
            bitmap: null,
            init: function(image, scale, startX, startY) {
                this.bitmap = new createjs.Bitmap(image);
                this.bitmap.scaleX = scale;
                this.bitmap.scaleY = scale;
                this.bitmap.x = startX;
                this.bitmap.y = startY;
                stage.addChild(this.bitmap);
            },
            animate: function() {
                createjs.Tween.get(this.bitmap, { loop: true })
                    .to({ x: 280, y: 312 }, 3000, createjs.Ease.getPowInOut(2))  // 3 seconds
                    .to({ x: 722, y: 466 }, 3000, createjs.Ease.getPowInOut(2))
                    .to({ x: 428, y: 163 }, 3000, createjs.Ease.getPowInOut(2));
            }
        };

        function handleImageLoad() {
            imagesLoaded++;
            if (imagesLoaded < 3) return; // Wait until all images are loaded

            // Initialize and add the background image
            deskPhotoBitmap = new createjs.Bitmap(deskPhotoImg);
            deskPhotoBitmap.scaleX = stage.canvas.width / deskPhotoImg.width;
            deskPhotoBitmap.scaleY = stage.canvas.height / deskPhotoImg.height;
            stage.addChild(deskPhotoBitmap);

            // Initialize and add the lizard man image
            lizardManBitmap = new createjs.Bitmap(lizardManImg);
            const headWidth = 100; // Approximate width of the head
            const headHeight = 120; // Approximate height of the head
            lizardManBitmap.scaleX = headWidth / lizardManImg.width;
            lizardManBitmap.scaleY = headHeight / lizardManImg.height;
            lizardManBitmap.x = 146;
            lizardManBitmap.y = 87;
            stage.addChild(lizardManBitmap);

            // Initialize and animate the minion
            minion = Object.create(Minion);
            const lizardScale = lizardManBitmap.scaleX; // Use the same scale as lizard
            minion.init(newImage, lizardScale, 428, 163);
            minion.animate();

            // Create a pointer circle
            pointer = new createjs.Shape();
            pointer.graphics.beginFill("red").drawCircle(0, 0, 5);
            stage.addChild(pointer);

            // Add an event listener for mouse movement
            stage.on("stagemousemove", function(event) {
                pointer.x = event.stageX;
                pointer.y = event.stageY;
                coordsDisplay.innerHTML = `Coordinates: (${Math.round(event.stageX)}, ${Math.round(event.stageY)})`;
            });

            // Start the EaselJS ticker
            createjs.Ticker.framerate = 60;
            createjs.Ticker.addEventListener("tick", tick);
        }

        // Tick function to update the stage
        function tick(event) {
            stage.update(event);
        }

        // Function to create a cloud shape and animate it
        function createCloud() {
            const cloud = new createjs.Shape();
            cloud.graphics.beginFill("white").drawEllipse(0, 0, 80, 40);
            cloud.x = 268; // X position of lizard's mouth
            cloud.y = 117; // Y position of lizard's mouth
            stage.addChild(cloud);

            createjs.Tween.get(cloud)
                .to({ y: cloud.y - 100, alpha: 0 }, 2000, createjs.Ease.getPowOut(2))
                .call(() => stage.removeChild(cloud));
        }

        // Event listener for pressing the Enter key
        document.addEventListener("keydown", function(event) {
            if (event.key === "Enter") {
                createCloud();
            }
        });
    </script>
</body>
</html>
